---
- name: Enable intranet service
  hosts: 3.7.147.243
  become: yes
  tasks:
          - name: latest version of httpd and firewalld installed
            dnf:
                    name:
                            - httpd
                            - python3
                            - firewalld
                    state: latest

          - name: deploy index.html file
            copy:
                    content: "welcome to apache "
                    dest: /var/www/html/index.html

          - name: restart firewalld
            service:
                    name: firewalld
                    enabled: true
                    state: started

          - name: firewalld permits access to httpd service
            firewalld:
                    service: http
                    permanent: true
                    state: enabled
                    immediate: yes

          - name: restart httpd
            service:
                    name: httpd
                    state: started
                    enabled: true
- name: Test Intranet web server
  hosts: localhost
  become: no
  tasks:
          - name: connect to intranet webserver
            uri:
                    url: http://3.7.147.243/
                    return_content: yes
                    status_code: 200
