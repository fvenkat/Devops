jQuery(function($){if(typeof wc_cart_params==='undefined'){return false;}var is_blocked=function($node){return $node.is('.processing')||$node.parents('.processing').length;};var block=function($node){if(!is_blocked($node)){$node.addClass('processing').block({message:null,overlayCSS:{background:'#fff',opacity:0.6}});}};var unblock=function($node){$node.removeClass('processing').unblock();};var get_url=function(endpoint){return wc_cart_params.wc_ajax_url.toString().replace('%%endpoint%%',endpoint);};var show_notice=function(html_element,$target){if(!$target){$target=$('.shop_table.cart').closest('form');}$target.before(html_element);};var update_cart_totals_div=function(html_str){$('.cart_totals').replaceWith(html_str);$(document.body).trigger('updated_cart_totals');};var coupon_cart_shipping={init:function(){jQuery(document).on('click','.promo-code-choosen-click',this.select_cashback_coupon_update_cart);jQuery(document).on('click','.md-placeholder.md-static',this.cart_view_offer);},cart_view_offer:function(evt){evt.preventDefault();var $this=$(evt.currentTarget);$this.parent().next('.md-select-menu-container').toggleClass('hide');},select_cashback_coupon_update_cart:function(evt){evt.preventDefault();var $coupon=$(evt.currentTarget);$form=$(evt.currentTarget).parents('form');coupon_cart_shipping.apply_coupon($form,$coupon.data('coupon'))},apply_coupon:function($form,coupon_code){block($form);var cart=this;var data={security:wc_cart_params.apply_coupon_nonce,coupon_code:coupon_code};$.ajax({type:'POST',url:get_url('apply_coupon'),data:data,dataType:'html',success:function(response){$('.woocommerce-error, .woocommerce-message, .woocommerce-info').remove();show_notice(response);$(document.body).trigger('applied_coupon');},complete:function(){unblock($form);coupon_cart_shipping.update_cart_totals();}});},update_cart_totals:function(){block($('div.cart_totals'));$.ajax({url:get_url('get_cart_totals'),dataType:'html',success:function(response){update_cart_totals_div(response);},complete:function(){unblock($('div.cart_totals'));}});},}
coupon_cart_shipping.init();});